ì¸í˜¸
inhooo00
ì˜¨ë¼ì¸
ê¹€ì‹ ì•„ â€” 2024. 10. 9. ì˜¤í›„ 11:25
ì¿¨ì¿¨ë ì–˜
ì¿¨ì¿¨
ì¿¨ì¿¨ë ì˜ˆ
ë“œë¥´ë  ë“œë¥´ë  ë“œë¥´ë  ëŒ€~~
ëª…ì§€ìš° â€” 2024. 10. 9. ì˜¤í›„ 11:57
ì•Œê³ ë³´ë‹ˆ í˜¼ì£ë§ì´ì—ˆë˜ê±°ì„
~
ê¹€ì‹ ì•„ â€” 2024. 10. 10. ì˜¤ì „ 12:03
ì±Œë¦°ì§€ ë§¤ë‹ˆì ˆ~
ì‰¿ì‰¿
ìì”~
í‘íã„±
íí«ã„±ã„±í‘ã„±íí‘.. í‘ê¸“íã…¡ã„±íí‘ íã…¡í‘
ì¼ë‹¨ ì•Œê²ŸìŒ ê°œë°œ ëë‚˜ë©´ console ì§€ìš¹ë ˆ
ì§€ìš¸ê²Œ
ê¹€ì‹ ì•„ â€” 2024. 10. 10. ì˜¤ì „ 12:18
ì• ë“¤ì•„ ë‚˜ë¹¨ë˜ ë„ê³ ì‹¶ì€ë°
ë‚˜ ë‚˜ê°€ë„ ë¼..?
ë‚˜ ì‚¬ì‹¤ ë¹¨ë˜ 2ì‹œê°„ë™ì•ˆ ë¬µí˜€ë‘ê³ ì‡ì–´
...................................................
í—ˆë½í•´ì£¼ì„¸ìš” ì£¼ì¸ë‹˜ í‘í‘
ê¹€ë™ê·  â€” 2024. 10. 10. ì˜¤ì „ 12:18
ê°€ì„¸ìš”
ê¹€ì‹ ì•„ â€” 2024. 10. 10. ì˜¤ì „ 12:18
ë¹¨ë˜ ë„ëŸ¬ ê°ˆ ìˆ˜ ìˆê²Œ ã…ë½í•´ì£¼ì„¸ìš”
ì•„ì‹¸ë¼ë¹„ìš©
ìµœê¸°ì›… â€” 2024. 10. 10. ì˜¤ì „ 12:20
ã…‹ã…‹ã…‹ã…‹ã…‹ã…‹ã…‹ã…‹ã…‹ã…‹ã…‹ã…‹ã…‹
ëª…ì§€ìš° â€” 2024. 10. 10. ì˜¤ì „ 12:21
ë¹ ì´ë¹ ì´
ê¹€ì‹ ì•„ â€” ì˜¤ëŠ˜ ì˜¤í›„ 10:00
ã…‹ã…‹ ã…ã…‡
ã…‡ã…‡!!
ì˜ˆìŠ¤~~
ì˜¤ìš°
í— ë¨¸ì„
ëª…ì§€ìš° â€” ì˜¤ëŠ˜ ì˜¤í›„ 10:02
ê·¼ë° ì–¸ë‹ˆ ì–´ë””ì•¼??
ê¹€ì‹ ì•„ â€” ì˜¤ëŠ˜ ì˜¤í›„ 10:03
ë‚˜ ì§€ê¸ˆ
ì§€í•˜ì²  ã…œ
ë‚˜
ì¹œêµ¬ ìƒì¼íŒŒí‹°ë¼
í•©ì°½ì—°ìŠµ
í•˜ëŠë¼ ì¡°ê¸ˆ ëŠ¦ì—ˆë„¤â€¦
ã…‡ã…‡ ë‚´ê°€ ì†Œí”„ë¼ë…¸ì„
â˜ºï¸
ì˜¤ëŠ˜ ì˜ìƒì°ìŒ ã…‹
ã…‡ã…‹
ë­ì„
ë™ê· ì´ ã…‹ã…‹ã…‹ã…‹ã…‹
ì´ê±°
ëˆ„ê°€ì§ ê²¨?
ì „ì—!
?
ê¹€ë™ê·  â€” ì˜¤ëŠ˜ ì˜¤í›„ 10:07
ã„±ã…‡
ê¹€ì‹ ì•„ â€” ì˜¤ëŠ˜ ì˜¤í›„ 10:07
ã…‡ã…
ì–¼ë¥¸ ë°°í¬í•´ë³´ìê¸”
ë™ì˜í•©ë‹ˆë‹¤
ì•¼í˜¸~
ì¬ì±„ê¸°ëˆ„êµ¬ì„
ì˜¤ ìˆ˜ê³ ìˆ˜ê³ 
ë‚˜ë„ ë‹¤í•¨
ê·¼ë°
ê·¸ sseê°€ ëë‹¤ ë§ì•—ë‹¤í•´ì‚¬
ë™ê· ì´ê°€ httpë²„ì „2
ì‚¬ìš©í•˜ë©´
íƒ­6ê°œë¡œ ì œí•œëœëŒ€
ã…‹ã…‹
ã…‡ã…‡
íì—‰ì›…
íì—‰ì—‰
ì• ë“¤ì•„
ë‚´ê°€ ë°©ê¸ˆ ì½”ë“œ ì˜ëª»ê³ ì¹œê±° ìƒê°ë‚¨
ì§€ê¸ˆ ì•„ì˜ˆ ì•Œë¦¼ ì¸ëœ°ë”ì„ ã…‹ã…‹
ã…ˆã……
ì§‘ê°€ì„œ ê³ ì¹¨
ê¹€ë™ê·  â€” ì˜¤ëŠ˜ ì˜¤í›„ 10:13
ã…‡ã…‹ ã…‹ã…‹
ì¸í˜¸ â€” ì˜¤ëŠ˜ ì˜¤í›„ 10:13
ê°œì›ƒê¸°ë„¤ ã…‹ã…‹
ê¹€ì‹ ì•„ â€” ì˜¤ëŠ˜ ì˜¤í›„ 10:14
ì‘ì‘
ì–´ë””ê°„ê²©??
ë‚˜ ê°„ê²© ì¤„ì—¿ëŠ”ë° ë³„ë¡œì—¬ì„œ ëŠ˜ë¦°ê±´ë°..í•˜í•«
ë‹¤ì‹œ ëŠ˜ë§‡ê²Œìš©
êº…
ã…‡ã…‡
ë‚´ì¼ ë°œí‘œì¸ë°
ã……ã…‚
ì•„ë¬´ê²ƒë„ ëª»ë«ã……ì•„
í‘í£í‘í«í‘íí‘
ğŸ¥¹
ì¸í˜¸ â€” ì˜¤ëŠ˜ ì˜¤í›„ 10:16
ì´ë¯¸ì§€
ê¹€ì‹ ì•„ â€” ì˜¤ëŠ˜ ì˜¤í›„ 10:18
ì•¼í˜¸~~
ã…‹ã…‹ã…‹ã…‹ã„±ã…‹ã…‹ã„±ã…‹ã„±ã„±ã…‹ã…‹ã„±ã…‹ã„±ã…‹ã„±ã…‹
í­í­
í•™ê²¨ê°€ ì—ë¥¸ ëˆì¤«ìœ¼ë©´
ë°°í¬ëŒ !
??
ã…‡ã…‹..
ë‚˜ 15ë¶„ë’¤ì—ë‚´ë¦¼
í—¤í—¤
ì•„ëƒ
ê·¸ ë’¤ì— ì˜¤ë¥˜ë‚˜ëŠ” ê±°
ë‚´ê°€ ë§¡ì€ê±°ì—ì„œ
ì˜¤ë£¨ë‚˜ë©´
ë‚´ê°€ ë‹¬ë ¤ê°€ê¸°ë¡œ í–ˆì–´
ì•¼í˜¸~~
ã…‹ã…‹ã…‹ã…‹ã…‹ã…‹ã…‹ã…‹ã…‹ã…‹ã…‹
ğŸ‘
ì‘ì• 
ê¹€ë™ê·  â€” ì˜¤ëŠ˜ ì˜¤í›„ 10:29
package shop.kkeujeok.kkeujeokbackend.block.application;

import static org.assertj.core.api.Assertions.assertThat;
import static org.assertj.core.api.Assertions.assertThatThrownBy;
import static org.junit.jupiter.api.Assertions.assertAll;
import static org.junit.jupiter.api.Assertions.assertNotNull;
import static org.mockito.ArgumentMatchers.any;
import static org.mockito.ArgumentMatchers.anyLong;
import static org.mockito.ArgumentMatchers.anyString;
import static org.mockito.Mockito.mock;
import static org.mockito.Mockito.times;
import static org.mockito.Mockito.verify;
import static org.mockito.Mockito.when;

import java.util.List;
import java.util.Optional;
import org.junit.jupiter.api.BeforeEach;
import org.junit.jupiter.api.DisplayName;
import org.junit.jupiter.api.Test;
import org.junit.jupiter.api.extension.ExtendWith;
import org.mockito.InjectMocks;
import org.mockito.Mock;
import org.mockito.junit.jupiter.MockitoExtension;
import org.springframework.data.redis.core.RedisTemplate;
import org.springframework.data.redis.core.ValueOperations;
import shop.kkeujeok.kkeujeokbackend.block.api.dto.request.BlockSaveReqDto;
import shop.kkeujeok.kkeujeokbackend.block.api.dto.request.BlockSequenceUpdateReqDto;
import shop.kkeujeok.kkeujeokbackend.block.api.dto.request.BlockUpdateReqDto;
import shop.kkeujeok.kkeujeokbackend.block.api.dto.response.BlockInfoResDto;
import shop.kkeujeok.kkeujeokbackend.block.domain.Block;
import shop.kkeujeok.kkeujeokbackend.block.domain.Progress;
import shop.kkeujeok.kkeujeokbackend.block.domain.repository.BlockRepository;
import shop.kkeujeok.kkeujeokbackend.block.exception.InvalidProgressException;
import shop.kkeujeok.kkeujeokbackend.dashboard.domain.Dashboard;
import shop.kkeujeok.kkeujeokbackend.dashboard.domain.repository.DashboardRepository;
import shop.kkeujeok.kkeujeokbackend.dashboard.personal.domain.PersonalDashboard;
import shop.kkeujeok.kkeujeokbackend.global.entity.Status;
import shop.kkeujeok.kkeujeokbackend.member.domain.Member;
import shop.kkeujeok.kkeujeokbackend.member.domain.SocialType;
import shop.kkeujeok.kkeujeokbackend.member.domain.repository.MemberRepository;

@ExtendWith(MockitoExtension.class)
class BlockServiceTest {

    @Mock
    private BlockRepository blockRepository;

    @Mock
    private MemberRepository memberRepository;

    @Mock
    private DashboardRepository dashboardRepository;

    @Mock
    private RedisTemplate<String, String> redisTemplate;

    @InjectMocks
    private BlockService blockService;

    private Member member;
    private Block block;
    private Block deleteBlock;
    private Dashboard dashboard;
    private BlockSaveReqDto blockSaveReqDto;
    private BlockUpdateReqDto blockUpdateReqDto;
    private BlockSequenceUpdateReqDto blockSequenceUpdateReqDto;

    @BeforeEach
    void setUp() {
        member = Member.builder()
                .email("email")
                .name("name")
                .nickname("nickname")
                .socialType(SocialType.GOOGLE)
                .introduction("introduction")
                .picture("picture")
                .build();

        when(memberRepository.findByEmail(anyString())).thenReturn(Optional.ofNullable(member));

        dashboard = PersonalDashboard.builder()
                .member(member)
                .title("title")
                .description("description")
                .isPublic(false)
                .category("category")
                .build();

        blockSaveReqDto = new BlockSaveReqDto(1L, "Title", "Contents", Progress.NOT_STARTED, "2024.07.03 13:23",
                "2024.07.25 13:23");
        blockUpdateReqDto = new BlockUpdateReqDto("UpdateTitle", "UpdateContents", "2024.07.03 13:23",
                "2024.07.28 16:40");

        blockSequenceUpdateReqDto = new BlockSequenceUpdateReqDto(
                dashboard.getId(),
                List.of(1L, 2L),
                List.of(3L, 4L),
                List.of(5L, 6L)
        );

... (214ì¤„ ë‚¨ìŒ)
ì ‘ê¸°
message.txt
12KB
ï»¿
package shop.kkeujeok.kkeujeokbackend.block.application;

import static org.assertj.core.api.Assertions.assertThat;
import static org.assertj.core.api.Assertions.assertThatThrownBy;
import static org.junit.jupiter.api.Assertions.assertAll;
import static org.junit.jupiter.api.Assertions.assertNotNull;
import static org.mockito.ArgumentMatchers.any;
import static org.mockito.ArgumentMatchers.anyLong;
import static org.mockito.ArgumentMatchers.anyString;
import static org.mockito.Mockito.mock;
import static org.mockito.Mockito.times;
import static org.mockito.Mockito.verify;
import static org.mockito.Mockito.when;

import java.util.List;
import java.util.Optional;
import org.junit.jupiter.api.BeforeEach;
import org.junit.jupiter.api.DisplayName;
import org.junit.jupiter.api.Test;
import org.junit.jupiter.api.extension.ExtendWith;
import org.mockito.InjectMocks;
import org.mockito.Mock;
import org.mockito.junit.jupiter.MockitoExtension;
import org.springframework.data.redis.core.RedisTemplate;
import org.springframework.data.redis.core.ValueOperations;
import shop.kkeujeok.kkeujeokbackend.block.api.dto.request.BlockSaveReqDto;
import shop.kkeujeok.kkeujeokbackend.block.api.dto.request.BlockSequenceUpdateReqDto;
import shop.kkeujeok.kkeujeokbackend.block.api.dto.request.BlockUpdateReqDto;
import shop.kkeujeok.kkeujeokbackend.block.api.dto.response.BlockInfoResDto;
import shop.kkeujeok.kkeujeokbackend.block.domain.Block;
import shop.kkeujeok.kkeujeokbackend.block.domain.Progress;
import shop.kkeujeok.kkeujeokbackend.block.domain.repository.BlockRepository;
import shop.kkeujeok.kkeujeokbackend.block.exception.InvalidProgressException;
import shop.kkeujeok.kkeujeokbackend.dashboard.domain.Dashboard;
import shop.kkeujeok.kkeujeokbackend.dashboard.domain.repository.DashboardRepository;
import shop.kkeujeok.kkeujeokbackend.dashboard.personal.domain.PersonalDashboard;
import shop.kkeujeok.kkeujeokbackend.global.entity.Status;
import shop.kkeujeok.kkeujeokbackend.member.domain.Member;
import shop.kkeujeok.kkeujeokbackend.member.domain.SocialType;
import shop.kkeujeok.kkeujeokbackend.member.domain.repository.MemberRepository;

@ExtendWith(MockitoExtension.class)
class BlockServiceTest {

    @Mock
    private BlockRepository blockRepository;

    @Mock
    private MemberRepository memberRepository;

    @Mock
    private DashboardRepository dashboardRepository;

    @Mock
    private RedisTemplate<String, String> redisTemplate;

    @InjectMocks
    private BlockService blockService;

    private Member member;
    private Block block;
    private Block deleteBlock;
    private Dashboard dashboard;
    private BlockSaveReqDto blockSaveReqDto;
    private BlockUpdateReqDto blockUpdateReqDto;
    private BlockSequenceUpdateReqDto blockSequenceUpdateReqDto;

    @BeforeEach
    void setUp() {
        member = Member.builder()
                .email("email")
                .name("name")
                .nickname("nickname")
                .socialType(SocialType.GOOGLE)
                .introduction("introduction")
                .picture("picture")
                .build();

        when(memberRepository.findByEmail(anyString())).thenReturn(Optional.ofNullable(member));

        dashboard = PersonalDashboard.builder()
                .member(member)
                .title("title")
                .description("description")
                .isPublic(false)
                .category("category")
                .build();

        blockSaveReqDto = new BlockSaveReqDto(1L, "Title", "Contents", Progress.NOT_STARTED, "2024.07.03 13:23",
                "2024.07.25 13:23");
        blockUpdateReqDto = new BlockUpdateReqDto("UpdateTitle", "UpdateContents", "2024.07.03 13:23",
                "2024.07.28 16:40");

        blockSequenceUpdateReqDto = new BlockSequenceUpdateReqDto(
                dashboard.getId(),
                List.of(1L, 2L),
                List.of(3L, 4L),
                List.of(5L, 6L)
        );

        block = Block.builder()
                .title(blockSaveReqDto.title())
                .contents(blockSaveReqDto.contents())
                .progress(blockSaveReqDto.progress())
                .startDate(blockSaveReqDto.startDate())
                .deadLine(blockSaveReqDto.deadLine())
                .member(member)
                .dashboard(dashboard)
                .build();

        deleteBlock = Block.builder()
                .title(blockSaveReqDto.title())
                .contents(blockSaveReqDto.contents())
                .progress(blockSaveReqDto.progress())
                .startDate(blockSaveReqDto.startDate())
                .deadLine(blockSaveReqDto.deadLine())
                .member(member)
                .dashboard(dashboard)
                .build();
        deleteBlock.statusUpdate();
    }

    @DisplayName("ë¸”ë¡ì„ ì €ì¥í•©ë‹ˆë‹¤.")
    @Test
    void ë¸”ë¡_ì €ì¥() {
        // given
        when(blockRepository.save(any(Block.class))).thenReturn(block);
        when(dashboardRepository.findById(anyLong())).thenReturn(Optional.of(dashboard));
        when(redisTemplate.opsForValue()).thenReturn(mock(ValueOperations.class));

        // when
        BlockInfoResDto result = blockService.save("email", blockSaveReqDto);

        // then
        assertAll(() -> {
            assertThat(result.title()).isEqualTo("Title");
            assertThat(result.contents()).isEqualTo("Contents");
            assertThat(result.progress()).isEqualTo(Progress.NOT_STARTED);
            assertThat(result.deadLine()).isEqualTo("2024.07.25 13:23");
            assertNotNull(result.nickname());
        });
    }

    @DisplayName("ë¸”ë¡ì„ ìˆ˜ì •í•©ë‹ˆë‹¤.")
    @Test
    void ë¸”ë¡_ìˆ˜ì •() {
        // given
        Long blockId = 1L;
        when(blockRepository.findById(blockId)).thenReturn(Optional.of(block));
        when(dashboardRepository.findById(block.getDashboard().getId())).thenReturn(Optional.of(dashboard));

        // when
        BlockInfoResDto result = blockService.update("email", blockId, blockUpdateReqDto);

        // then
        assertAll(() -> {
            assertThat(result.title()).isEqualTo("UpdateTitle");
            assertThat(result.contents()).isEqualTo("UpdateContents");
            assertThat(result.deadLine()).isEqualTo("2024.07.28 16:40");
        });
    }

    @DisplayName("ë¸”ë¡ ì œëª©ê³¼ ë‚´ìš©ì´ ê¸°ì¡´ê³¼ ë™ì¼í•˜ë©´ ìˆ˜ì • í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.")
    @Test
    void ë¸”ë¡_ìˆ˜ì •_X() {
        // given
        Long blockId = 1L;
        BlockUpdateReqDto originBlockUpdateReqDto = new BlockUpdateReqDto("Title", "Contents", "2024.07.03 13:23",
                "2024.07.25 13:23");
        when(blockRepository.findById(blockId)).thenReturn(Optional.of(block));
        when(dashboardRepository.findById(block.getDashboard().getId())).thenReturn(Optional.of(dashboard));

        // when
        BlockInfoResDto result = blockService.update("email", blockId, originBlockUpdateReqDto);

        // then
        assertAll(() -> {
            assertThat(result.title()).isEqualTo("Title");
            assertThat(result.contents()).isEqualTo("Contents");
            assertThat(block.getUpdatedAt()).isNull();
        });
    }

    @DisplayName("ë¸”ë¡ì˜ ìƒíƒœë¥¼ ìˆ˜ì •í•©ë‹ˆë‹¤.")
    @Test
    void ë¸”ë¡_ìƒíƒœ_ìˆ˜ì •() {
        // given
        Long blockId = 1L;
        when(blockRepository.findById(blockId)).thenReturn(Optional.of(block));
        when(dashboardRepository.findById(block.getDashboard().getId())).thenReturn(Optional.of(dashboard));

        // when
        BlockInfoResDto result = blockService.progressUpdate("email", blockId, "IN_PROGRESS");

        // then
        assertAll(() -> {
            assertThat(result.title()).isEqualTo("Title");
            assertThat(result.contents()).isEqualTo("Contents");
            assertThat(result.progress()).isEqualTo(Progress.IN_PROGRESS);
        });
    }

    @DisplayName("ë¸”ë¡ì˜ ìƒíƒœë¥¼ ìˆ˜ì •í•˜ëŠ”ë° ì‹¤íŒ¨í•©ë‹ˆë‹¤.(Progress ë¬¸ìì—´ íŒŒì‹± ì‹¤íŒ¨)")
    @Test
    void ë¸”ë¡_ìƒíƒœ_ìˆ˜ì •_ì‹¤íŒ¨() {
        // given
        Long blockId = 1L;
        when(blockRepository.findById(blockId)).thenReturn(Optional.of(block));

        // when & then
        assertThatThrownBy(() -> blockService.progressUpdate("email", blockId, "String"))
                .isInstanceOf(InvalidProgressException.class);
    }

    @DisplayName("ë¸”ë¡ì„ ì‚­ì œ í•©ë‹ˆë‹¤.")
    @Test
    void ë¸”ë¡_ì‚­ì œ() {
        // given
        Long blockId = 1L;
        when(blockRepository.findById(blockId)).thenReturn(Optional.of(block));
        when(dashboardRepository.findById(block.getDashboard().getId())).thenReturn(Optional.of(dashboard));

        // when
        blockService.delete("email", blockId);

        // then
        assertAll(() -> {
            assertThat(block.getStatus()).isEqualTo(Status.DELETED);
        });
    }

    @DisplayName("ì‚­ì œë˜ì—ˆë˜ ë¸”ë¡ì„ ë³µêµ¬í•©ë‹ˆë‹¤.")
    @Test
    void ë¸”ë¡_ë³µêµ¬() {
        // given
        Long blockId = 1L;
        when(blockRepository.findById(blockId)).thenReturn(Optional.of(deleteBlock));
        when(dashboardRepository.findById(block.getDashboard().getId())).thenReturn(Optional.of(dashboard));

        // when
        blockService.delete("email", blockId);

        // then
        assertAll(() -> {
            assertThat(deleteBlock.getStatus()).isEqualTo(Status.ACTIVE);
        });
    }

    @DisplayName("ë¸”ë¡ì„ ìƒì„¸ ë´…ë‹ˆë‹¤.")
    @Test
    void ë¸”ë¡_ìƒì„¸ë³´ê¸°() {
        // given
        Long blockId = 1L;
        when(blockRepository.findById(blockId)).thenReturn(Optional.of(block));

        // when
        BlockInfoResDto result = blockService.findById("email", blockId);

        // then
        assertAll(() -> {
            assertThat(result.title()).isEqualTo("Title");
            assertThat(result.contents()).isEqualTo("Contents");
            assertThat(result.progress()).isEqualTo(Progress.NOT_STARTED);
            assertThat(result.deadLine()).isEqualTo("2024.07.25 13:23");
            assertNotNull(result.nickname());
        });
    }

    @DisplayName("ë¸”ë¡ì˜ ìˆœë²ˆì„ ë³€ê²½í•©ë‹ˆë‹¤.")
    @Test
    void ë¸”ë¡_ìˆœë²ˆ_ë³€ê²½() {
        // given
        when(blockRepository.findById(anyLong())).thenReturn(Optional.of(block));
        when(dashboardRepository.findById(block.getDashboard().getId())).thenReturn(Optional.of(dashboard));

        // when
        blockService.changeBlocksSequence("email", blockSequenceUpdateReqDto);

        // then
        verify(blockRepository, times(6)).findById(anyLong());  // 6ë²ˆ ë¸”ë¡ ì¡°íšŒê°€ ì´ë£¨ì–´ì¡ŒëŠ”ì§€ ê²€ì¦
    }

    @DisplayName("ë¸”ë¡ì„ ì˜êµ¬ ì‚­ì œ í•©ë‹ˆë‹¤.")
    @Test
    void ë¸”ë¡_ì˜êµ¬_ì‚­ì œ() {
        // given
        Long blockId = 1L;
        when(blockRepository.findById(blockId)).thenReturn(Optional.of(deleteBlock));
        when(dashboardRepository.findById(block.getDashboard().getId())).thenReturn(Optional.of(dashboard));

        // when
        blockService.deletePermanently("email", blockId);

        // then
        verify(blockRepository, times(1)).delete(deleteBlock);
    }

    @DisplayName("ì‚­ì œëœ ë¸”ë¡ì„ ì „ì²´ ì‚­ì œí•©ë‹ˆë‹¤.")
    @Test
    void ì‚­ì œ_ë¸”ë¡_ì „ì²´_ì‚­ì œ() {
        // given
        Long dashboardId = 1L;
        List<Block> deletedBlocks = List.of(deleteBlock);
        when(blockRepository.findByDeletedBlocks(dashboardId)).thenReturn(deletedBlocks);
        when(dashboardRepository.findById(dashboardId)).thenReturn(Optional.of(dashboard));

        // when
        blockService.deleteAllPermanently("email", dashboardId);

        // then
        verify(blockRepository).deleteAll(deletedBlocks);
    }

}
message.txt
12KB